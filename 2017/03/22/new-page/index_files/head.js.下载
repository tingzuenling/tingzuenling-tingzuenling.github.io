var LW201310_Userinfo = {	dUserId : 0,	dArea : 0,	dPageURI : "http://lol.qq.com/web201310/",	dAppsAPIURI : "http://apps.game.qq.com/lol/api/v2013/",	dCookieKey : "LOL_API_W2013_USER_",	dCookieTime : 3600,    dRankName:{'bronze':'英勇黄铜','silver':'不屈白银','gold':'荣耀黄金','platinum':'华贵铂金','diamond':'璀璨钻石','master':'超凡大师','challenger':'最强王者'},    dUserRank:'',	init : function() {		var self = LW201310_Userinfo;		self.userLogininfo();		self.CallGoJFCloud();	},	userLogininfo : function() {//登录QQ后的信息，绑定大区或未绑定大区		var self = LW201310_Userinfo;		need("biz.login",function(LoginManager){			LoginManager.checkLogin(function(){				var cookieKey = self.dCookieKey+LoginManager.getUserUin(),                    cookieKeyArea = self.dCookieKey+LoginManager.getUserUin()+ 'Area';				var tmp = milo.cookie.get(cookieKey),                    tmpArea = milo.cookie.get(cookieKeyArea);				if(tmp){//一小时内登录过并且绑定过大区					var cookieValue = tmp.split(",");					self.dUserId = cookieValue[0];					self.dArea = cookieValue[1];					g("jUserName").innerHTML = decodeURI(cookieValue[2]);					g("jUserArea").innerHTML = '<a href="javascript:LW201310_Userinfo.userLogin();">'+LOLServerSelect.zoneToName(cookieValue[1]) +'</a>';					g("jUserGames").innerHTML = cookieValue[5];					g("jUserRP").innerHTML = cookieValue[6];					g("jUserIP").innerHTML = cookieValue[7];					g("jUserRS").innerHTML = cookieValue[8];                    if(cookieValue[9]){                        rankHtml = '<span class="login-rank rank-'+ cookieValue[9].toLowerCase() +'"></span>';                        g("jUserRank").innerHTML = self.dRankName[cookieValue[9].toLowerCase()];                    }else{                        rankHtml='';                        g("jUserRank").innerHTML = '暂无';                    }                    g("jUserIcon").innerHTML = '<a href="'+self.dPageURI+'personal.shtml?id='+self.dUserId+'&area='+self.dArea+'"><img width="80" height="80" src="http://ossweb-img.qq.com/images/lol/img/profileicon2/profileicon'+cookieValue[4]+'.jpg" alt="">'+'<span class="login-lv">'+cookieValue[3]+'</span>'+ rankHtml +'</a>';					g("jUserLoginDiv").style.display = 'none';					g("jUserLoginedDiv").style.display = '';									}else if(tmpArea){//一小时后cookie失效，但大区绑定过                    self.userBaseinfo(LoginManager.getUserUin(), tmpArea);				}else{//首次登录，未绑定过大区                    g("jUserLoginP").innerHTML = '您已登录，请<a href="javascript:LW201310_Userinfo.userLogin();">绑定大区</a>，或者<a href="javascript:LW201310_Userinfo.userLogout();">注销</a>';                }			});		});	},	userLogin : function() {//拉取QQ登录信息		var self = LW201310_Userinfo;		need(["biz.login", "biz.roleselector"], function(LoginManager, RoleSelector){			LoginManager.init({needReloadPage:true});			LoginManager.checkLogin(function(){				RoleSelector.init({					'gameId' : 'lol', 					'isQueryRole' : true, 					'isShutdownSubmit' : true,					'submitEvent' : function(roleObject){						var p1 = LoginManager.getUserUin();						var p2 = roleObject.submitData.areaid;//                        console.log(p1 + '   ' +p2)						self.userBaseinfo(p1, p2);											}				});				RoleSelector.show();			}, function(){				LoginManager.login();			});		});	},	userBaseinfo : function(p1, p2) {//登录完QQ并且首次绑定大区后的信息		var self = LW201310_Userinfo;		var cookieKey = self.dCookieKey+p1,            cookieKeyArea = self.dCookieKey+p1+'Area';		var submitURI = self.dAppsAPIURI+"summoner.php?p2="+p2+"&r="+Math.random();;		loadScript(submitURI, function(){			var retHTML = '';			if(0==retObj.status) {				var data = retObj.msg,                    cookieValue = new Array(data.info.id,data.info.area,data.info.name,data.info.level,data.info.icon,data.info.games,data.money.rp,data.money.ip,data.credit,data.tier.tier),                    cookieAreaValue = data.info.area,                    rankHtml = '';                console.log(data.tier)				milo.cookie.set(cookieKey, cookieValue.join(","), 3600, document.domain, "/", false);                milo.cookie.set(cookieKeyArea, cookieAreaValue, 2592000, document.domain, "/", false);                self.dUserId = cookieValue[0];				self.dArea = cookieValue[1];				g("jUserName").innerHTML = decodeURI(cookieValue[2]);                g("jUserArea").innerHTML = '<a href="javascript:LW201310_Userinfo.userLogin();">'+LOLServerSelect.zoneToName(cookieValue[1]) +'</a>';				g("jUserGames").innerHTML = cookieValue[5];				g("jUserRP").innerHTML = cookieValue[6];				g("jUserIP").innerHTML = cookieValue[7];				g("jUserRS").innerHTML = cookieValue[8];                g("jUserRank").innerHTML = self.dRankName[cookieValue[9].toLowerCase()];                if(cookieValue[9]){                    rankHtml = '<span class="login-rank rank-'+ cookieValue[9].toLowerCase() +'"></span>';                    g("jUserRank").innerHTML = self.dRankName[cookieValue[9].toLowerCase()];                }else{                    rankHtml='';                    g("jUserRank").innerHTML = '暂无';                }                g("jUserIcon").innerHTML = '<a href="'+self.dPageURI+'personal.shtml?id='+self.dUserId+'&area='+self.dArea+'"><img width="80" height="80" src="http://ossweb-img.qq.com/images/lol/img/profileicon2/profileicon'+cookieValue[4]+'.jpg" alt="">'+'<span class="login-lv">'+cookieValue[3]+'</span>'+ rankHtml +'</a>';				g("jUserLoginDiv").style.display = 'none';				g("jUserLoginedDiv").style.display = '';				self.reloadBattlePage();			}		});	},	reloadBattlePage : function() {		var self = LW201310_Userinfo;		var currenturl = window.location;		var personal = self.dPageURI + "personal.shtml";		if(personal == currenturl) {			location.reload();		}	},	userLogout : function() {		var self = LW201310_Userinfo;		need(["biz.login"], function(LoginManager){						LoginManager.checkLogin(function(){				//var cookieKey = self.dCookieKey+LoginManager.getUserUin();				//milo.cookie.set(cookieKey, '', 1, document.domain, "/", false);				LoginManager.logout(function(){					location.reload(); 				});			});		});	},	CallGoJFCloud : function() {//add by ralfshen		var submitURI = "http://apps.game.qq.com/lol/Go/userpoint/PointInfo?acctid=A100003&areaid=&roleid=&action=2&r="+Math.random();;		loadScript(submitURI, function(){});			}}/*  |xGv00|c60c4736ed533713d9098f9b8a6b23d0 */